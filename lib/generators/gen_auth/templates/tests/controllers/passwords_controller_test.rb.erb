require "test_helper"

class <%= class_name.pluralize %>::PasswordsControllerTest < ActionDispatch::IntegrationTest
  test "changing passwords" do
    <%= singular_name %> = <%= plural_name %>(:james)
    <%= singular_name %>_log_in_as(<%= singular_name %>)

    patch <%= plural_name %>_settings_passwords_url, params: {
      password: {
        current_password: "It's m3?",
        password: "n3w p4ssw0rd!",
        password_confirmation: "n3w p4ssw0rd!"
      }
    }

    assert_redirected_to <%= plural_name %>_settings_url
    assert_equal "Successfully changed your password.", flash[:notice]
  end

  test "invalid password_params" do
    <%= singular_name %> = <%= plural_name %>(:james)
    <%= singular_name %>_log_in_as(<%= singular_name %>)

    patch <%= plural_name %>_settings_passwords_url, params: {
      password: {
        current_password: "It's m3?",
        password: "n3w p4ssw0rd!",
        password_confirmation: "they don't match"
      }
    }

    assert_redirected_to <%= plural_name %>_settings_url
    assert_equal "Failed to change your password.", flash[:alert]
  end
end