require "test_helper"

class <%= class_name %>Test < ActiveSupport::TestCase
  test "password validation" do
    <%= singular_name %> = <%= plural_name %>(:james)
    <%= singular_name %>.password = "short"
    refute <%= singular_name %>.valid?

    <%= singular_name %>.password = "this password is too long. it's more than 72 characters which BCrypt cannot support."
    refute <%= singular_name %>.valid?

    <%= singular_name %>.password = "just the right mix"
    assert <%= singular_name %>.valid?
  end
end
